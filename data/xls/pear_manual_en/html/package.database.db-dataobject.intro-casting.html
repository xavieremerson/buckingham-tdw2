<HTML
><HEAD
><TITLE
>Casting - Dates, Blobs and Null</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="PEAR Manual"
HREF="index.html"><LINK
REL="UP"
TITLE="DB_DataObject"
HREF="package.database.db-dataobject.html"><LINK
REL="PREVIOUS"
TITLE="DB_DataObject::raiseError"
HREF="package.database.db-dataobject.db-dataobject.raiseerror.html"><LINK
REL="NEXT"
TITLE="DB_DataObject_FormBuilder"
HREF="package.database.db-dataobject-formbuilder.html"><META
HTTP-EQUIV="Content-type"
CONTENT="text/html; charset=ISO-8859-1"></HEAD
><BODY
CLASS="refentry"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PEAR Manual</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="package.database.db-dataobject.db-dataobject.raiseerror.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="package.database.db-dataobject-formbuilder.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="package.database.db-dataobject.intro-casting">Casting - Dates, Blobs and Null</H1
><DIV
CLASS="refnamediv"
><A
NAME="AEN27497"
></A
>Casting - Dates, Blobs and Null&nbsp;--&nbsp;
       DB_DataObject_Cast   ::date(), ::blob(), ::sql()
      </DIV
><DIV
CLASS="refsect1"
><A
NAME="AEN27500"
></A
><H2
>Dealing with Casting, (everything except strings and numbers)</H2
><DIV
CLASS="warning"
><P
></P
><TABLE
CLASS="warning"
BORDER="1"
WIDTH="100%"
><TR
><TD
ALIGN="CENTER"
><B
>Warning</B
></TD
></TR
><TR
><TD
ALIGN="LEFT"
><P
>&#13;        This is experimental!, although it is documented, it currently only supports a limited amount of databases (send
        me fixes if you want it to support your favorite database), and the internal operations/API may change in the future..
        </P
></TD
></TR
></TABLE
></DIV
><P
>&#13;        DataObjects is a very easy way to work with databases that are focused on numbers and strings. You can also 
        use it on date fields (although you must format your strings correctly), and you can use it with other types
        by using raw SQL query(), and the string value "null" is automatically converted to NULL in the database.
      </P
><P
>&#13;       In an effort to provide a cleaner way to code to the richer database types, the DB_DataObject_Cast object was created.
       It's purpose is to simply create an object to represent some of the more unusual types. Below is an example of using it
       to create a few simple types.
      </P
><P
>&#13;       Cast Objects can be used in both building queries, and assigning values
    

      <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="example"
><A
NAME="AEN27507"><P
><B
>Example 33-1.  Cast Objects for building and assigning values</B
></P
><TABLE
WIDTH="100%"
CELLSPACING="0"
CELLPADDING="0"
BORDER="0"
BGCOLOR="#EEEEEE"
><TR
><TD
><PRE
CLASS="php"
>&#60;?php

// using Cast Objects for building a query.

$person = DB_DataObject::factory('person');


// assign the value of birthday to a Cast object with a date.
$person-&#62;birthday =  DB_DataObject_Cast::date(2000,12,30);


$person-&#62;find();
while ($person-&#62;fetch()) {
    echo "{$person-&#62;name} has a birthday on 30 december 2002&#60;BR&#62;";
}



// use Cast Objects for assigning values.


$person = DB_DataObject::factory('person');
$person-&#62;get(12);

// set the persons's birthday to 30 december 2000
$person-&#62;birthday = DB_DataObject_Cast::date(2000,12,30);

// now update the database.
$person-&#62;update();

?&#62;</PRE
></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
>
        
        </P
><P
>&#13;      As you can see, This component is in it"s infancy, so if you have any feature requests, ideas, please do not hesitate
      to contact me at alan_k at php dot net.

      </P
></DIV
><DIV
CLASS="refsect1"
><A
NAME="AEN27511"
></A
><H2
>The blob and string type</H2
><P
>&#13;        Blobs are fields which can store large amounts of binary data in the databases. 
        
      </P
><P
>&#13;        At present only blobs is only supported in postgres using the bytea type. 
        (please email me with code for other databases.)
        
      </P
><P
>&#13;        
        <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="example"
><A
NAME="AEN27516"><P
><B
>Example 33-2.  Inserting a photo and a big text file</B
></P
><TABLE
WIDTH="100%"
CELLSPACING="0"
CELLPADDING="0"
BORDER="0"
BGCOLOR="#EEEEEE"
><TR
><TD
><PRE
CLASS="php"
>&#60;?php


$person = DB_DataObject::factory('person');
$person-&#62;name = 'fred'

// use blob for binary data.
$person-&#62;photo =  DB_DataObject_Cast::blob(file_get_contents('xxx.jpg'));

// use string for textural data into a blob type.
$person-&#62;xmldocs =  DB_DataObject_Cast::string(file_get_contents('xxx.xml'));

// now insert into the database.
$person-&#62;insert();
 

?&#62;</PRE
></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
>
      </P
></DIV
><DIV
CLASS="refsect1"
><A
NAME="AEN27519"
></A
><H2
>The date type</H2
><P
>&#13;        Most dates are stored in a database in ISO standard format, this method, allows you to create date types, from
        either Year,month,day,  Human readable day/month/year, or standard iso format year-month-day.
        It fills in the remaining values based on simple rules.
        
        
      </P
><P
>&#13;        
        <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="example"
><A
NAME="AEN27523"><P
><B
>Example 33-3.  Inserting a date in various formats</B
></P
><TABLE
WIDTH="100%"
CELLSPACING="0"
CELLPADDING="0"
BORDER="0"
BGCOLOR="#EEEEEE"
><TR
><TD
><PRE
CLASS="php"
>&#60;?php


$person = DB_DataObject::factory('person');
$person-&#62;name = 'fred'

// use a human readable date

// full format
$person-&#62;birthday = new DB_DataObject_Cast::date('21/12/2003');

// use only a month/year - actually sets to 1 december 2003
$person-&#62;expires =  DB_DataObject_Cast::date('12/2003');

// use only a year only - actually sets to 1 jan 2003
$person-&#62;expires = DB_DataObject_Cast::date(2003);





// use a iso formated

// full formated
$person-&#62;birthday =  DB_DataObject_Cast::date('2003-12-21');

// use only a year-month - actually sets to 1 december 2003
$person-&#62;expires =  DB_DataObject_Cast::date('2003-12');




// using array syntax

// full formated
$person-&#62;birthday =  DB_DataObject_Cast::date(2003,12,21);

// use only a year-month  - actually sets to 1 december 2003
$person-&#62;expires =  DB_DataObject_Cast::date(2003,12);



// the real values are stored in object variables 

echo $person-&#62;birthday-&#62;year; // prints 2003
echo $person-&#62;birthday-&#62;month; // prints 12
echo $person-&#62;birthday-&#62;day; // prints 21




// you can do simple date addition (similar to mktime)

$d = DB_DataObject_Cast::date('01/12/2003');

$nextMonth = DB_DataObject_Cast::date($d-&#62;year,$d-&#62;month+1,1);



?&#62;</PRE
></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
>
      </P
></DIV
><DIV
CLASS="refsect1"
><A
NAME="AEN27526"
></A
><H2
>The sql type</H2
><P
>&#13;        Some types are sql specific, or may even be database specific, you can use the sql type to put raw strings
        as part of the sql statement.
        
        
      </P
><P
>&#13;        
        <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="example"
><A
NAME="AEN27530"><P
><B
>Example 33-4.  using raw sql</B
></P
><TABLE
WIDTH="100%"
CELLSPACING="0"
CELLPADDING="0"
BORDER="0"
BGCOLOR="#EEEEEE"
><TR
><TD
><PRE
CLASS="php"
>&#60;?php
$person = DB_DataObject::factory('person');
$person-&#62;get(12);

// set the birthday to null.
$person-&#62;birthday =  DB_DataObject_Cast::sql('NULL');

// do a sql cast statement (postgres specific)
$data = DB_DataObject_Cast::sql('cast("123123",datetime)');



// now insert into the database.
$person-&#62;insert();
 


?&#62;</PRE
></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
>
      </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="package.database.db-dataobject.db-dataobject.raiseerror.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="package.database.db-dataobject-formbuilder.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>DB_DataObject::raiseError</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="package.database.db-dataobject.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>DB_DataObject_FormBuilder</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>