<HTML
><HEAD
><TITLE
>Introduction - Query</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="PEAR Manual"
HREF="index.html"><LINK
REL="UP"
TITLE="MDB2"
HREF="package.database.mdb2.html"><LINK
REL="PREVIOUS"
TITLE="Introduction - Connect"
HREF="package.database.mdb2.intro-connect.html"><LINK
REL="NEXT"
TITLE="Introduction - Results"
HREF="package.database.mdb2.intro-fetch.html"><META
HTTP-EQUIV="Content-type"
CONTENT="text/html; charset=ISO-8859-1"></HEAD
><BODY
CLASS="refentry"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PEAR Manual</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="package.database.mdb2.intro-connect.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="package.database.mdb2.intro-fetch.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="package.database.mdb2.intro-query">Introduction - Query</H1
><DIV
CLASS="refnamediv"
><A
NAME="AEN31283"
></A
>Introduction - Query&nbsp;--&nbsp;Performing queries</DIV
><DIV
CLASS="refsect1"
><A
NAME="package.database.mdb2.intro-query.desc"
></A
><H2
>Description</H2
><P
>&#13;   PEAR MDB2 provides several methods for querying databases.
   The most direct method is
   <A
HREF="http://pear.php.net/package/MDB2/docs/latest/MDB2/MDB2_Driver_Common.html#methodquery"
TARGET="_top"
>&#13;    <B
CLASS="function"
>query()</B
></A
>.
   It takes a SQL query string as an argument.
   There are two possible returns:
   A new MDB2_Result object for queries that return results (such as
   <B
CLASS="command"
>SELECT</B
> queries), or a MDB2_Error object on failure.
   It should not be used with statements that manipulate data (such as
   <B
CLASS="command"
>INSERT</B
> queries)
  </P
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="example"
><A
NAME="AEN31293"><P
><B
>Example 33-1. Doing a query</B
></P
><TABLE
WIDTH="100%"
CELLSPACING="0"
CELLPADDING="0"
BORDER="0"
BGCOLOR="#EEEEEE"
><TR
><TD
><PRE
CLASS="php"
>&#60;?php
// Create a valid MDB2 object named $mdb2
// at the beginning of your program...
require_once 'MDB2.php';

$mdb2 =&#38; MDB2::connect('pgsql://usr:pw@localhost/dbnam');
if (PEAR::isError($mdb2)) {
    die($mdb2-&#62;getMessage());
}

// Proceed with a query...
$res =&#38; $mdb2-&#62;query('SELECT * FROM clients');

// Always check that result is not an error
if (PEAR::isError($res)) {
    die($res-&#62;getMessage());
}
?&#62;</PRE
></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
><P
>&#13;   <A
HREF="http://pear.php.net/package/MDB2/docs/latest/MDB2/MDB2_Driver_Common.html#methodexec"
TARGET="_top"
>&#13;    <B
CLASS="function"
>exec()</B
></A
> should be used for manipulation queries.
   There are two possible returns:
   An integer denoting the number of affected rows for statements that manipulate data
   (such as <B
CLASS="command"
>INSERT</B
> queries), or a MDB2_Error object on failure.
   It should not be used with statements that return results (such as
   <B
CLASS="command"
>SELECT</B
> queries)
  </P
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="example"
><A
NAME="AEN31301"><P
><B
>Example 33-2. Using exec to manipulate data</B
></P
><TABLE
WIDTH="100%"
CELLSPACING="0"
CELLPADDING="0"
BORDER="0"
BGCOLOR="#EEEEEE"
><TR
><TD
><PRE
CLASS="php"
>&#60;?php
// Once you have a valid MDB2 object named $mdb2...
$sql  = "INSERT INTO clients (name, address) VALUES ($name, $address)";

$affected =&#38; $mdb2-&#62;exec($sql);

// Always check that result is not an error
if (PEAR::isError($affected)) {
    die($affected-&#62;getMessage());
}
?&#62;</PRE
></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="refsect1"
><A
NAME="package.database.mdb2.intro-query.datatypes"
></A
><H2
>Data types</H2
><P
>&#13;    MDB2 supports a number of data types across all drivers. These can be set
    for result sets in all relevant methods.
    You can find an overview of the supported data types and their format
    <A
HREF="http://cvs.php.net/viewcvs.cgi/*checkout*/pear/MDB2/docs/datatypes.html"
TARGET="_top"
>&#13;    here</A
>.
   </P
></DIV
><DIV
CLASS="refsect1"
><A
NAME="package.database.mdb2.intro-query.setlimit"
></A
><H2
>Limiting rows and reading from an offset</H2
><P
>&#13;    In order to read/write to only a limited number of rows from a result set
    and/or to start reading from a specific offset the
    <A
HREF="http://pear.php.net/package/MDB2/docs/latest/MDB2/MDB2_Driver_Common.html#methodsetLimit"
TARGET="_top"
>&#13;    <B
CLASS="function"
>setLimit()</B
></A
> can be called prior to issueing the
    query. The limit and offset will only affected the next method call that
    will issue a query or prepare a statement and will automatically be reset
    after issueing the query. This also applies to any internal queries issues
    inside MDB2. Note that limit may not work with DML statements on RDBMS that
    emulate limit support and no error will be raised.
   </P
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="example"
><A
NAME="AEN31313"><P
><B
>Example 33-3. Using setLimit with query and exec</B
></P
><TABLE
WIDTH="100%"
CELLSPACING="0"
CELLPADDING="0"
BORDER="0"
BGCOLOR="#EEEEEE"
><TR
><TD
><PRE
CLASS="php"
>&#60;?php
// Once you have a valid MDB2 object named $mdb2...

$sql = "SELECT * FROM clients";
// read 20 rows with an offset of 10
$mdb2-&#62;setLimit(20, 10);
$affected =&#38; $mdb2-&#62;exec($sql);

$sql = "DELETE FROM clients";
if ($mdb2-&#62;supported('limit_queries') === 'emulated') {
    echo 'offset will likely be ignored'
}
// only delete 10 rows
$mdb2-&#62;setLimit(10);
$affected =&#38; $mdb2-&#62;exec($sql);

?&#62;</PRE
></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="package.database.mdb2.intro-connect.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="package.database.mdb2.intro-fetch.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Introduction - Connect</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="package.database.mdb2.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Introduction - Results</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>