<HTML
><HEAD
><TITLE
>Structure of a post-install script</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="PEAR Manual"
HREF="index.html"><LINK
REL="UP"
TITLE="Post-installation Scripts"
HREF="guide.migrating.postinstall.html"><LINK
REL="PREVIOUS"
TITLE="Post-installation Scripts"
HREF="guide.migrating.postinstall.html"><LINK
REL="NEXT"
TITLE="Core components"
HREF="core.html"><META
HTTP-EQUIV="Content-type"
CONTENT="text/html; charset=ISO-8859-1"></HEAD
><BODY
CLASS="sect1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PEAR Manual</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="guide.migrating.postinstall.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 25. Post-installation Scripts</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="core.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="sect1"
><H1
CLASS="sect1"
><A
NAME="guide.migrating.postinstall.structure">Structure of a post-install script</H1
><P
>&#13;   The post-install script class must contain two methods, one named <B
CLASS="function"
>init()</B
>,
   and the other named <B
CLASS="function"
>run()</B
>.  The <B
CLASS="function"
>init()</B
> method is called
   at the same time as all other post-install scripts.  The <B
CLASS="function"
>run()</B
> method is
   called at the conclusion of each parameter group in order to process the user's responses
   to queries.
  </P
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="guide.migrating.postinstall.structure.init">The <B
CLASS="function"
>init()</B
> method</H2
><P
>&#13;    <DIV
CLASS="funcsynopsis"
><A
NAME="AEN3961"><P
></P
><P
><CODE
><CODE
CLASS="FUNCDEF"
>void <B
CLASS="function"
>init</B
></CODE
> (PEAR_Config $config, PEAR_PackageFile_v2 $self, string|null $lastInstalledVersion)</CODE
></P
><P
></P
></DIV
>
   </P
><P
>&#13;    <P
></P
><DIV
CLASS="variablelist"
><DL
><DT
><A
HREF="core.ppm.pear-config.html"
>PEAR_Config</A
> <TT
CLASS="parameter"
><I
>$xml</I
></TT
></DT
><DD
><P
>&#13;        The current configuration used for installation.
       </P
></DD
><DT
>PEAR_PackageFile_v2 <TT
CLASS="parameter"
><I
>$self</I
></TT
></DT
><DD
><P
>&#13;        The package.xml contents as abstracted by this object.
       </P
></DD
><DT
>string|<TT
CLASS="constant"
><B
>NULL</B
></TT
> <TT
CLASS="parameter"
><I
>$lastInstalledVersion</I
></TT
></DT
><DD
><P
>&#13;        The last version of this package that was installed.  This is a very important
        parameter, as it is the only way to determine whether a package is being installed
        from scratch, or upgraded from a previous version.  Using this parameter, it is
        possible to determine what incremental changes, if any, need to be performed.
       </P
></DD
></DL
></DIV
>
   </P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="guide.migrating.postinstall.structure.run">The <B
CLASS="function"
>run()</B
> method</H2
><P
>&#13;    <DIV
CLASS="funcsynopsis"
><A
NAME="AEN3995"><P
></P
><P
><CODE
><CODE
CLASS="FUNCDEF"
>bool <B
CLASS="function"
>run</B
></CODE
> (array $infoArray, string $paramGroupId)</CODE
></P
><P
></P
></DIV
>
   </P
><P
>&#13;    <P
></P
><DIV
CLASS="variablelist"
><DL
><DT
>array <TT
CLASS="parameter"
><I
>$infoArray</I
></TT
></DT
><DD
><P
>&#13;        if <TT
CLASS="varname"
>$paramGroupId</TT
> is <TT
CLASS="literal"
>_undoOnError</TT
>, then
        $infoArray will contain a list of successfully completed parameter group
        sections.  This can be used to restore any system changes made by the installation
        script.
       </P
><P
>&#13;        Otherwise, <TT
CLASS="varname"
>$infoArray</TT
> contains the results of the user input
        from the most recent &#60;paramgroup&#62; section.
       </P
></DD
><DT
>string <TT
CLASS="parameter"
><I
>$paramGroupId</I
></TT
></DT
><DD
><P
>&#13;        This variable either contains <TT
CLASS="literal"
>_undoOnError</TT
> or the contents
        of the most recent &#60;paramgroup&#62;'s &#60;id&#62; tag.  Note that paramgroup
        id cannot begin with an underscore (<TT
CLASS="literal"
>_</TT
>), and so
        <TT
CLASS="literal"
>_undoOnError</TT
> can only be triggered by the PEAR installer.
       </P
></DD
></DL
></DIV
>
   </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="guide.migrating.postinstall.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="core.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Post-installation Scripts</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="guide.migrating.postinstall.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Core components</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>